<?xml version="1.0" encoding="utf-8"?>
<package
  name="epi"
  displayName="Epidemic Base Package"
  version="1.0.0">
  <transformers>
    <transformer
      name="Primary"
      isPrimary="True"
      displayName="Epidemic"
      className="SyncroSim.Epi.PrimaryTransformer"
      classAssembly="SyncroSim.Epi"
      configurationSheet="RunControl">
      <include>
        <transformer name="corestime_Runtime"/>
        <transformer name="InputOutputBridge"/>        
      </include>
      <datafeeds>
        <datafeed name="Variable" displayName="Variables" dataScope="Project">
          <datasheets>
            <datasheet name="Variable" displayName="Variables" valueMember="VariableID" displayMember="Name" filter="IsInternal IS NULL OR IsInternal=0" className="SyncroSim.Epi.VariableDataSheet" classAssembly="SyncroSim.Epi">
              <columns>
                <column name="VariableID" dataType="Integer" isPrimary="True"/>
                <column name="ProjectID" dataType="Integer"/>
                <column name="Name" dataType="String"/>
                <column name="Description" dataType="String"/>
                <column name="IsInternal" dataType="Boolean" isVisible="False"/>
              </columns>
              <defaultRecords>
                <record columns="Name|IsInternal" values="Cases|-1"/>
                <record columns="Name|IsInternal" values="Deaths|-1"/>
                <record columns="Name|IsInternal" values="Population|-1"/>
              </defaultRecords>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="Jurisdiction" displayName="Jurisdictions" dataScope="Project">
          <datasheets>
            <datasheet name="Jurisdiction" displayName="Jurisdictions" valueMember="JurisdictionID" displayMember="Name">
              <columns>
                <column name="JurisdictionID" dataType="Integer" isPrimary="True"/>
                <column name="ProjectID" dataType="Integer"/>
                <column name="Name" dataType="String"/>
                <column name="Description" dataType="String"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="RunControl" displayName="Run Control" dataScope="Scenario">
          <datasheets>
            <datasheet name="RunControl" displayName="Run Control" isSingleRow="True">
              <columns>
                <column name="RunControlID" dataType="Integer" isPrimary="True"/>
                <column name="ScenarioID" dataType="Integer"/>
                <column name="MinimumTimestep" displayName="Start Date" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" format="d"/>
                <column name="MaximumTimestep" displayName="End Date" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" format="d"/>
                <column name="MinimumIteration" displayName="Minimum Iteration" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="1" format="d"/>
                <column name="MaximumIteration" displayName="Number of Iterations" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="1" format="d"/>
                <column name="ModelHistoricalDeaths" displayName="Model Historical Deaths (Y/N)" dataType="Boolean"/>
                <column name="StartDate" displayName="Start Date" dataType="Date" validationType="Date"/>
                <column name="EndDate" displayName="End Date" dataType="Date" validationType="Date"/>
              </columns>
            </datasheet>
            <datasheet name="RuntimeJurisdiction" displayName="Runtime Jurisdiction">
              <columns>
                <column name="RuntimeJurisdictionID" dataType="Integer" isPrimary="True"/>
                <column name="ScenarioID" dataType="Integer"/>
                <column name="Jurisdiction" dataType="Integer" validationType="Datasheet" formula1="Jurisdiction" allowDbNull="False"/>
              </columns>
              <validations>
                <validation validationType="Unique" columns="Jurisdiction"/>
              </validations>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="DataSummaryInput" displayName="Summary Input" dataScope="Scenario">
          <datasheets>
            <datasheet name="DataSummaryInput" displayName="Summary Input">
              <columns>
                <column name="DataSummaryInputID" dataType="Integer" isPrimary="True"/>
                <column name="ScenarioID" displayName="Scenario" dataType="Integer"/>
                <column name="Iteration" dataType="Integer" isOptional="True"/>
                <column name="Timestep" displayName="Date" dataType="Date" validationType="Date" isOptional="True"/>                
                <column name="Variable" dataType="Integer" validationType="Datasheet" formula1="Variable" allowDbNull="False"/>               
                <column name="Jurisdiction" dataType="Integer" validationType="Datasheet" formula1="Jurisdiction" allowDbNull="False"/>
                <column name="AgeMin" displayName="Age Min" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" isOptional="True"/>
                <column name="AgeMax" displayName="Age Max" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" isOptional="True"/>
                <column name="Sex" dataType="Integer" validationType="List" formula1="0:Male|1:Female" isOptional="True"/>              
                <column name="Value" dataType="Double" allowDbNull="False"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="DataSummaryOutput" displayName="Summary Output" dataScope="Scenario" isOutput="True">
          <datasheets>
            <datasheet name="DataSummaryOutput" displayName="Summary Output">
              <columns>
                <column name="ScenarioID" displayName="Scenario" dataType="Integer" isCompositeIndex="True"/>
                <column name="Iteration" dataType="Integer" isCompositeIndex="True" allowDbNull="False"/>
                <column name="Timestep" dataType="Integer" displayName="Timestep" isCompositeIndex="True" allowDbNull="False"/>
                <column name="Date" displayName="Date" dataType="Date" validationType="Date" allowDbNull="False"/>                   
                <column name="Variable" dataType="Integer" validationType="Datasheet" formula1="Variable" allowDbNull="False" isCompositeIndex="True"/>               
                <column name="Jurisdiction" dataType="Integer" validationType="Datasheet" formula1="Jurisdiction" allowDbNull="False" isCompositeIndex="True"/>
                <column name="AgeMin" displayName="Age Min" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" isCompositeIndex="True"/>
                <column name="AgeMax" displayName="Age Max" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" isCompositeIndex="True"/>
                <column name="Sex" dataType="Integer" validationType="List" formula1="0:Male|1:Female" isCompositeIndex="True"/>             
                <column name="Value" dataType="Double" allowDbNull="False"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>        
      </datafeeds>
    </transformer>
    <transformer 
      name="InputOutputBridge" 
      displayName="Input / Output Bridge"
      className="SyncroSim.Epi.InputOutputBridge"
      classAssembly="SyncroSim.Epi"
      isRunnable="True">      
    </transformer>
  </transformers>
  <layouts>
    <layout name="coreforms_LibraryDatafeeds">
      <item name="core_SysFolder"/>
      <item name="core_Backup"/>
      <item name="core_Multiprocessing"/>
      <item name="core_Options"/>
      <item name="core_Rconfig"/>
    </layout>
    <layout name="coreforms_ProjectDatafeeds">
      <item name="Variable"/>
      <item name="Jurisdiction"/>
      <group name="Pipeline">
        <item name="core_Transformer"/>
        <item name="core_StageName"/>
        <item name="core_StageValue"/>        
      </group>
    </layout>
    <layout name="coreforms_ScenarioDatafeeds">
      <item name="RunControl"/>
      <group name="Inputs">       
      </group>
      <group name="Outputs"> 
        <item name="DataSummaryOutput" runRequired="True"/>         
      </group>
      <item name="core_Pipeline"/>  
    </layout>
    <layout name="coreforms_ResultTransformers">
      <item name="corestime_ChartTransformer"/>
    </layout>
    <layout 
      name="corestimeforms_Charts" 
      configurationSheet="RunControl" 
      minDateTimeColumn="StartDate" 
      maxDateTimeColumn="EndDate" 
      xAxisValueType="DateTime" 
      xAxisIntervalType="Days" 
      xAxisLabelFormat="MMM-dd">
      <group name="Variables" dataSheet="DataSummaryOutput" filter="Jurisdiction">
        <item name="Variable" dataSheet="DataSummaryOutput" column="Value" variableSourceColumn="Variable"/>        
      </group>
    </layout>
  </layouts>
  <views>
    <view
      name="RunControlDataFeedView"
      target="RunControl"
      className="SyncroSim.Epi.RunControlDataFeedView"
      classAssembly="SyncroSim.Epi"/>
  </views>
</package>